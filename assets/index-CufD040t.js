var ds=Object.defineProperty;var us=(s,t,a)=>t in s?ds(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a;var X=(s,t,a)=>us(s,typeof t!="symbol"?t+"":t,a);import{r as g,j as e,V as Te,a as Pe,A as Oe,C as Ue,X as Le,T as Me,D as Be,P as ms,b as ze,c as fs,S as gs,R as hs,d as ee,e as ps,f as xs,I as vs,u as $e,g as Ge,h as bs,i as ys,k as ws,l as js,O as qe,m as Ns,n as He,o as Ss,p as We,q as Ve,s as As,t as Ye,w as ks,x as _s,y as Qe,z as Cs,B as Es,E as le,F as Rs,G as T,H as Ke,J as Z,L as Q,K as ce,M as Fs,N as be,Q as se,U as Ds,W as Is,Y as Ts,Z as Ps,_ as te,$ as Os,a0 as Us,a1 as Ls,a2 as Ms,a3 as ye,a4 as G,a5 as Bs,a6 as zs,a7 as $s}from"./react-vendor-B-V_8rzG.js";import{b as Gs,c as de}from"./data-processing-GsMK5QcL.js";import{b as k,d as ue}from"./ui-libs-dZeq81fN.js";import{y as qs,z as Hs,$ as Ws,B as we,D as je,E as Ne}from"./vendor-CtQlsnd7.js";import{B as M,D as V,a as Se}from"./barcode-scanning-459UoB7n.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const h of i.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function a(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=a(r);fetch(r.href,i)}})();const Vs=new Gs({defaultOptions:{queries:{staleTime:1e3*60*5,gcTime:1e3*60*30,retry:2,refetchOnWindowFocus:!1}}});function j(...s){return qs(k(s))}const Ys=ms,Xe=g.forwardRef(({className:s,...t},a)=>e.jsx(Te,{ref:a,className:j("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...t}));Xe.displayName=Te.displayName;const Qs=ue("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Je=g.forwardRef(({className:s,variant:t,...a},n)=>e.jsx(Pe,{ref:n,className:j(Qs({variant:t}),s),...a}));Je.displayName=Pe.displayName;const Ks=g.forwardRef(({className:s,...t},a)=>e.jsx(Oe,{ref:a,className:j("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...t}));Ks.displayName=Oe.displayName;const Xs=g.forwardRef(({className:s,...t},a)=>e.jsx(Ue,{ref:a,className:j("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...t,children:e.jsx(Le,{className:"h-4 w-4"})}));Xs.displayName=Ue.displayName;const Js=g.forwardRef(({className:s,...t},a)=>e.jsx(Me,{ref:a,className:j("text-sm font-semibold",s),...t}));Js.displayName=Me.displayName;const Zs=g.forwardRef(({className:s,...t},a)=>e.jsx(Be,{ref:a,className:j("text-sm opacity-90",s),...t}));Zs.displayName=Be.displayName;function et(){const[s,t]=g.useState([]);return e.jsxs(Ys,{children:[s.map(a=>e.jsx(Je,{...a},a.id)),e.jsx(Xe,{})]})}const st=({...s})=>{const{theme:t="system"}=Hs();return e.jsx(Ws,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...s})},tt=fs,at=g.forwardRef(({className:s,sideOffset:t=4,...a},n)=>e.jsx(ze,{ref:n,sideOffset:t,className:j("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a}));at.displayName=ze.displayName;const nt=ue("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),E=g.forwardRef(({className:s,variant:t,size:a,asChild:n=!1,...r},i)=>{const h=n?gs:"button";return e.jsx(h,{className:j(nt({variant:t,size:a,className:s})),ref:i,...r})});E.displayName="Button";const P=g.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:j("rounded-lg border bg-card text-card-foreground shadow-sm",s),...t}));P.displayName="Card";const z=g.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:j("flex flex-col space-y-1.5 p-6",s),...t}));z.displayName="CardHeader";const $=g.forwardRef(({className:s,...t},a)=>e.jsx("h3",{ref:a,className:j("text-2xl font-semibold leading-none tracking-tight",s),...t}));$.displayName="CardTitle";const Ze=g.forwardRef(({className:s,...t},a)=>e.jsx("p",{ref:a,className:j("text-sm text-muted-foreground",s),...t}));Ze.displayName="CardDescription";const O=g.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:j("p-6 pt-0",s),...t}));O.displayName="CardContent";const rt=g.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:j("flex items-center p-6 pt-0",s),...t}));rt.displayName="CardFooter";class it extends hs.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,a){console.error("ErrorBoundary caught an error:",t,a)}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-background",children:e.jsxs(P,{className:"w-full max-w-md",children:[e.jsxs(z,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 h-12 w-12 rounded-full bg-destructive/10 flex items-center justify-center",children:e.jsx(ee,{className:"h-6 w-6 text-destructive"})}),e.jsx($,{children:"Something went wrong"}),e.jsx(Ze,{children:"An unexpected error occurred. Please try refreshing the app."})]}),e.jsxs(O,{className:"space-y-4",children:[e.jsx(E,{onClick:()=>window.location.reload(),className:"w-full",children:"Refresh App"}),!1]})]})}):this.props.children}}const ot=1,lt=1e6;let ae=0;function ct(){return ae=(ae+1)%Number.MAX_SAFE_INTEGER,ae.toString()}const ne=new Map,Ae=s=>{if(ne.has(s))return;const t=setTimeout(()=>{ne.delete(s),J({type:"REMOVE_TOAST",toastId:s})},lt);ne.set(s,t)},dt=(s,t)=>{switch(t.type){case"ADD_TOAST":return{...s,toasts:[t.toast,...s.toasts].slice(0,ot)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(a=>a.id===t.toast.id?{...a,...t.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=t;return a?Ae(a):s.toasts.forEach(n=>{Ae(n.id)}),{...s,toasts:s.toasts.map(n=>n.id===a||a===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(a=>a.id!==t.toastId)}}},ut=[];let re={toasts:[]};function J(s){re=dt(re,s),ut.forEach(t=>{t(re)})}function U({...s}){const t=ct(),a=r=>J({type:"UPDATE_TOAST",toast:{...r,id:t}}),n=()=>J({type:"DISMISS_TOAST",toastId:t});return J({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:r=>{r||n()}}}),{id:t,dismiss:n,update:a}}const mt={UPC_A:/^\d{12}$/,UPC_E:/^\d{8}$/,EAN_13:/^\d{13}$/,EAN_8:/^\d{8}$/,CODE_128:/^[\x00-\x7F]+$/,CODE_39:/^[A-Z0-9\-\.\s\$\/\+\%]+$/};function ie(s){if(!s||typeof s!="string")return!1;const t=s.trim();return Object.values(mt).some(a=>a.test(t))}function oe(s){return!s||typeof s!="string"?"":s.replace(/[^A-Za-z0-9\-\.\s\$\/\+\%]/g,"").trim()}class ft{constructor(t=10,a=6e4){X(this,"requests",new Map);X(this,"maxRequests");X(this,"timeWindow");this.maxRequests=t,this.timeWindow=a}isAllowed(t){const a=Date.now(),r=(this.requests.get(t)||[]).filter(i=>a-i<this.timeWindow);return r.length>=this.maxRequests?!1:(r.push(a),this.requests.set(t,r),!0)}}const ke=new ft(10,6e4);function gt({onScanResult:s}){const[t,a]=g.useState(!1),[n,r]=g.useState(!1),[i,h]=g.useState(""),[u,o]=g.useState(null),[p,A]=g.useState(0),_=()=>{o(null),p>0&&A(0)},L=(d,f)=>{console.error(`Scan failed from ${f}:`,d);const m=p+1;A(m),m>=3?(o("Having trouble scanning? Try better lighting, hold the device steady, or enter the barcode manually."),m>=4&&!n&&setTimeout(()=>r(!0),1500)):m>=2?o("Barcode not detected. Try again with better lighting or clearer image."):o("Couldn't recognize a barcode. Please try again."),U({title:"Scan Failed",description:f==="camera"?"No barcode detected. Try with better lighting or a clearer image.":"No barcode found in this image. Try another photo or scan directly.",variant:"destructive"}),a(!1)},R=async d=>{const f=document.createElement("img");f.src=d,await new Promise(c=>f.onload=c);const m=await q(d),x=document.createElement("img");x.src=m,await new Promise(c=>x.onload=c);const w=new Map,N=[M.EAN_13,M.EAN_8,M.UPC_A,M.UPC_E,M.CODE_128,M.CODE_39,M.ITF,M.CODABAR];w.set(V.POSSIBLE_FORMATS,N),w.set(V.TRY_HARDER,!0),w.set(V.CHARACTER_SET,"UTF-8"),w.set(V.ASSUME_GS1,!0),w.set(V.PURE_BARCODE,!1);try{const c=new Se(w);try{const v=await c.decodeFromImage(x);if(v){const b=v.getText();if(C(v)>=.75)return b}}catch{console.log("First pass scan failed, trying original image")}try{const v=await c.decodeFromImage(f);if(v)return v.getText()}catch{console.log("Second pass scan failed, trying multi-orientation")}return await F(f,w)}catch(c){throw console.error("All barcode recognition attempts failed:",c),new Error("No barcode detected")}},q=async d=>new Promise(f=>{const m=document.createElement("img");m.onload=()=>{const x=document.createElement("canvas"),w=x.getContext("2d");if(!w){f(d);return}x.width=m.width,x.height=m.height,w.drawImage(m,0,0);const N=w.getImageData(0,0,x.width,x.height),c=N.data;let v=0;for(let S=0;S<c.length;S+=4)v+=(c[S]+c[S+1]+c[S+2])/3;const b=v/(c.length/4);for(let S=0;S<c.length;S+=4){const K=.299*c[S]+.587*c[S+1]+.114*c[S+2];let H=120;b<100?H=90:b>200&&(H=160);const W=K<H?0:255;c[S]=W,c[S+1]=W,c[S+2]=W}w.putImageData(N,0,0),f(x.toDataURL("image/png"))},m.src=d}),F=async(d,f)=>{const m=[0,90,180,270],x=new Se(f);for(const w of m)try{const N=l(d,w),c=document.createElement("img");c.src=N.toDataURL("image/png"),await new Promise(b=>c.onload=b);const v=await x.decodeFromImage(c);if(v)return v.getText()}catch{console.log(`Failed at ${w} degrees`)}throw new Error("No barcode detected in any orientation")},l=(d,f)=>{const m=document.createElement("canvas"),x=m.getContext("2d");if(!x)throw new Error("Could not get canvas context");return f===90||f===270?(m.width=d.height,m.height=d.width):(m.width=d.width,m.height=d.height),x.translate(m.width/2,m.height/2),x.rotate(f*Math.PI/180),x.drawImage(d,-d.width/2,-d.height/2),m},C=d=>{const f=d.getResultMetadata();if(!f)return .5;const m=f.get(2)??!1,x=!f.has(3),w=f.has(4);let N=.5;return m&&(N+=.2),x&&(N+=.2),w&&(N+=.1),Math.min(N,1)},D=async()=>{try{if(!ke.isAllowed("barcode_scan")){U({title:"Rate limit exceeded",description:"Please wait before scanning again",variant:"destructive"});return}a(!0),_();const d=await we.getPhoto({quality:90,allowEditing:!1,resultType:Ne.DataUrl,source:je.Camera});if(!d.dataUrl)throw new Error("No image data received from camera");const f=await R(d.dataUrl);if(!ie(f)){U({title:"Invalid barcode format",description:"The detected barcode is not in a valid format",variant:"destructive"});return}const m=oe(f);U({title:"Product Scanned Successfully!",description:`Analyzing barcode: ${m}`}),s(m)}catch(d){L(d,"camera")}finally{a(!1)}},I=async()=>{try{if(!ke.isAllowed("image_scan")){U({title:"Rate limit exceeded",description:"Please wait before scanning again",variant:"destructive"});return}a(!0),_();const d=await we.getPhoto({quality:90,allowEditing:!1,resultType:Ne.DataUrl,source:je.Photos});if(!d.dataUrl)throw new Error("No image data received");const f=await R(d.dataUrl);if(!ie(f)){U({title:"Invalid barcode format",description:"The detected barcode is not in a valid format",variant:"destructive"});return}const m=oe(f);U({title:"Product Scanned Successfully!",description:`Analyzing barcode: ${m}`}),s(m)}catch(d){L(d,"gallery")}finally{a(!1)}},y=d=>{if(d.preventDefault(),ie(i)){const f=oe(i);U({title:"Product Code Entered",description:`Analyzing code: ${f}`}),s(f),r(!1),h("")}else U({title:"Invalid Format",description:"Please enter a valid product barcode",variant:"destructive"})};return e.jsxs(P,{className:"w-full max-w-md mx-auto shadow-lg border-0 bg-gradient-to-br from-background to-muted/20",children:[e.jsxs(z,{className:"text-center pb-4",children:[e.jsxs($,{className:"flex items-center justify-center gap-3 text-xl",children:[e.jsx("img",{src:"/gusto-logo.svg",alt:"Gusto Logo",className:"w-8 h-8"}),"Gusto Scanner"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Scan products for instant evidence-based insights"})]}),e.jsxs(O,{className:"space-y-6",children:[u&&e.jsxs("div",{className:"bg-destructive/10 text-destructive text-sm p-3 rounded-md flex items-start gap-2",children:[e.jsx(ee,{className:"h-5 w-5 flex-shrink-0 mt-0.5"}),e.jsx("p",{children:u})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-40 h-40 border-2 border-dashed border-primary/30 rounded-2xl flex items-center justify-center bg-primary/5",children:e.jsx(ps,{className:"h-16 w-16 text-primary/60"})})}),n?e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"manualBarcode",className:"text-sm font-medium",children:"Enter product barcode manually:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{id:"manualBarcode",type:"text",value:i,onChange:d=>h(d.target.value),placeholder:"e.g., 5901234123457",className:"flex-1 px-3 py-2 bg-background border rounded-md text-foreground"}),e.jsx(E,{type:"submit",size:"sm",children:"Search"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter the numbers printed below the barcode"})]}),e.jsx(E,{type:"button",variant:"ghost",size:"sm",onClick:()=>r(!1),className:"text-xs",children:"Go back to scanning"})]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{onClick:D,disabled:t,className:"w-full h-14 text-lg font-semibold bg-primary hover:bg-primary/90 shadow-lg",size:"lg",children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}),"Analyzing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(xs,{className:"h-5 w-5 mr-3"}),"Scan Product"]})}),e.jsxs(E,{onClick:I,disabled:t,variant:"outline",className:"w-full h-12 border-2 border-primary/20 hover:border-primary/40 hover:bg-primary/5",size:"lg",children:[e.jsx(vs,{className:"h-4 w-4 mr-2"}),"Upload Image"]}),e.jsx(E,{onClick:()=>r(!0),variant:"ghost",className:"w-full h-10 text-sm text-muted-foreground",children:"Enter barcode manually"})]}),e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-xs text-primary font-medium",children:"ðŸŒ± Supports Barcodes & QR Codes â€¢ ðŸ”¬ Scientific Evidence-Based â€¢ ðŸŒ Environmental Impact"})})]})]})}const me=de.create({baseURL:"https://world.openfoodfacts.org/api/v2",timeout:1e4,headers:{"User-Agent":"Gusto - https://github.com/Acex619/eco-ai-food-lens"}}),es=de.create({baseURL:"https://api.nal.usda.gov/fdc/v1",timeout:1e4,headers:{"User-Agent":"Gusto - https://github.com/Acex619/eco-ai-food-lens"}}),ss=de.create({baseURL:"https://data.efsa.europa.eu/api/v1",timeout:1e4,headers:{"User-Agent":"Gusto - https://github.com/Acex619/eco-ai-food-lens"}}),fe=s=>{s.interceptors.response.use(t=>t,t=>{if(t.response)switch(t.response.status){case 404:throw new Error("Product not found in database");case 429:throw new Error("Too many requests. Please try again later");case 401:throw new Error("Authentication error. Please check API credentials");case 403:throw new Error("Access denied. You may need additional permissions");default:throw new Error(`Server error: ${t.response.status}`)}else throw t.request?new Error("Network error. Please check your connection"):new Error("Error making request")})};fe(me);fe(es);fe(ss);const ht=async s=>{var n,r;const a=(r=(n=Object.entries({"palm oil":{references:[{title:"Environmental impacts of palm oil",url:"https://www.sciencedirect.com/science/article/abs/pii/S0959652618330221",source:"PubMed",publicationYear:2019,abstract:"Analysis of environmental impacts of palm oil production including deforestation and biodiversity loss",confidenceScore:.9,peerReviewed:!0},{title:"Palm oil and health risks",url:"https://www.efsa.europa.eu/en/topics/topic/palm-oil",source:"EFSA",publicationYear:2022,confidenceScore:.8,peerReviewed:!0}]},aspartame:{references:[{title:"Safety evaluation of aspartame",url:"https://www.efsa.europa.eu/en/topics/topic/aspartame",source:"EFSA",publicationYear:2020,confidenceScore:.85,peerReviewed:!0},{title:"FDA approved aspartame safety",url:"https://www.fda.gov/food/food-additives-petitions/aspartame-use-food",source:"FDA",publicationYear:2021,confidenceScore:.8,peerReviewed:!0}]}}).find(([i])=>s.toLowerCase().includes(i)))==null?void 0:n[1])==null?void 0:r.references;return{references:a?a.map(i=>({...i,confidenceScore:i.confidenceScore??.8,peerReviewed:i.peerReviewed??!0})):[]}},_e=async s=>{const t={dairy:{carbonFootprintScore:2.8,waterUsage:628,waterSource:"Agribalyse",landUse:12.4,landUseScore:5,deforestationRisk:"Low",biodiversityImpact:4.2,transportEmissions:.3,packagingWaste:.12,dataReliability:85},meat:{carbonFootprintScore:27,waterUsage:15415,waterSource:"Ecoinvent",landUse:326.2,landUseScore:9,deforestationRisk:"High",biodiversityImpact:8.7,transportEmissions:.5,packagingWaste:.08,dataReliability:90},vegetables:{carbonFootprintScore:.5,waterUsage:322,waterSource:"Agribalyse",landUse:.3,landUseScore:2,deforestationRisk:"None",biodiversityImpact:1.2,transportEmissions:.8,packagingWaste:.15,dataReliability:75}},a=Object.keys(t).find(n=>s.toLowerCase().includes(n));return a?t[a]:{carbonFootprintScore:0,waterUsage:0,waterSource:"Estimated",landUse:0,landUseScore:0,deforestationRisk:"Low",biodiversityImpact:0,transportEmissions:0,packagingWaste:0,dataReliability:40}},pt=s=>{const t=["fr","de","it","es","nl","be","pt","pl","se","dk","fi","ie","at","gr","cz"],a=["us","usa","united-states"],n=[];return s.some(r=>t.some(i=>r.includes(i)))&&n.push("EU"),s.some(r=>a.some(i=>r.includes(i)))&&n.push("US"),n.length===0&&n.push("Global"),{availableIn:n,lastVerified:new Date().toISOString().split("T")[0]}},xt=async s=>{try{const t=await me.get(`/product/${s}`);if(!t.data.product)throw new Error("Product not found");const a=t.data.product,n={...a};n.marketData=pt(a.countries_tags||[]);let r;if(a.categories_tags&&a.categories_tags.length>0){const i=a.categories_tags[0];r=await _e(i)}else r=await _e("unknown");if(n.environmental_data=r,a.ingredients&&a.ingredients.length>0){const i=await Promise.all(a.ingredients.map(async h=>{const u=h.text||h.id||"";if(h.from_palm_oil||u.match(/aspartame|msg|artificial|flavor|color|preservative/i)){const o=await ht(u);return{...h,scientific_references:o.references,health_concerns:h.from_palm_oil?["Environmental impact","Potential health risks"]:void 0}}return h}));n.ingredients=i}return n.data_quality_score=bt(n),n.last_updated=new Date().toISOString().split("T")[0],n}catch(t){throw t instanceof Error?t:new Error("Failed to fetch product data")}},vt=async s=>{const t={openFoodFacts:{success:!1,data:null,error:null},usda:{success:!1,data:null,error:null},efsa:{success:!1,data:null,error:null}};try{const n=(await me.get(`/product/${s}.json`)).data;n.status===1?t.openFoodFacts={success:!0,data:n.product,error:null}:t.openFoodFacts={success:!1,data:null,error:"Product not found in Open Food Facts"}}catch(a){t.openFoodFacts={success:!1,data:null,error:typeof a=="object"&&a!==null&&"message"in a?a.message:"Error fetching from Open Food Facts"}}try{const a=s.startsWith("0")?s.substring(1):s,r=(await es.get("/foods/search",{params:{query:a,pageSize:1}})).data;r.foods&&r.foods.length>0?t.usda={success:!0,data:r.foods[0],error:null}:t.usda={success:!1,data:null,error:"Product not found in USDA database"}}catch(a){t.usda={success:!1,data:null,error:typeof a=="object"&&a!==null&&"message"in a?a.message:"Error fetching from USDA"}}try{const n=(await ss.get("/food-products/search",{params:{identifier:s,limit:1}})).data;n&&n.results&&n.results.length>0?t.efsa={success:!0,data:n.results[0],error:null}:t.efsa={success:!1,data:null,error:"Product not found in EFSA database"}}catch(a){t.efsa={success:!1,data:null,error:typeof a=="object"&&a!==null&&"message"in a?a.message:"Error fetching from EFSA"}}return t};function bt(s){var a;let t=50;if(s.product_name&&(t+=5),s.brands&&(t+=5),s.image_front_url&&(t+=5),s.ingredients&&s.ingredients.length>0&&(t+=10),s.nutriscore_grade&&(t+=10),s.nutriments&&(t+=5),(a=s.environmental_data)!=null&&a.dataReliability&&(t+=s.environmental_data.dataReliability/10),s.last_updated){const n=new Date(s.last_updated),i=(new Date().getTime()-n.getTime())/(1e3*3600*24);i<30?t+=10:i<90?t+=5:i>365&&(t-=10)}return Math.min(100,Math.max(0,t))}const yt=s=>$e({queryKey:["food",s],queryFn:()=>xt(s),enabled:!!s}),wt=s=>$e({queryKey:["multiSourceProduct",s],queryFn:()=>vt(s),enabled:!!s,retry:2,staleTime:1e3*60*60,gcTime:1e3*60*60*24}),jt=ue("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function B({className:s,variant:t,...a}){return e.jsx("div",{className:j(jt({variant:t}),s),...a})}const Y=g.forwardRef(({className:s,value:t,...a},n)=>e.jsx(Ge,{ref:n,className:j("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...a,children:e.jsx(bs,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Y.displayName=Ge.displayName;const Ce=ys,Ee=ws,Re=js,Nt=As,St=Ns,ts=g.forwardRef(({className:s,...t},a)=>e.jsx(qe,{ref:a,className:j("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t}));ts.displayName=qe.displayName;const as=g.forwardRef(({className:s,children:t,...a},n)=>e.jsxs(St,{children:[e.jsx(ts,{}),e.jsxs(He,{ref:n,className:j("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...a,children:[t,e.jsxs(Ss,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Le,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));as.displayName=He.displayName;const ns=({className:s,...t})=>e.jsx("div",{className:j("flex flex-col space-y-1.5 text-center sm:text-left",s),...t});ns.displayName="DialogHeader";const rs=g.forwardRef(({className:s,...t},a)=>e.jsx(We,{ref:a,className:j("text-lg font-semibold leading-none tracking-tight",s),...t}));rs.displayName=We.displayName;const is=g.forwardRef(({className:s,...t},a)=>e.jsx(Ve,{ref:a,className:j("text-sm text-muted-foreground",s),...t}));is.displayName=Ve.displayName;const os=g.forwardRef(({className:s,children:t,...a},n)=>e.jsxs(Ye,{ref:n,className:j("relative overflow-hidden",s),...a,children:[e.jsx(ks,{className:"h-full w-full rounded-[inherit]",children:t}),e.jsx(ls,{}),e.jsx(_s,{})]}));os.displayName=Ye.displayName;const ls=g.forwardRef(({className:s,orientation:t="vertical",...a},n)=>e.jsx(Qe,{ref:n,orientation:t,className:j("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...a,children:e.jsx(Cs,{className:"relative flex-1 rounded-full bg-border"})}));ls.displayName=Qe.displayName;const At=(s,t,a)=>{const n=s.toLowerCase(),r={"sodium benzoate":"A preservative used to prevent spoilage in acidic foods by inhibiting bacterial and fungal growth.","potassium sorbate":"A food preservative that prevents mold, yeast, and fungal growth in various food products.","citric acid":"A natural acid found in citrus fruits, commonly used as a preservative and flavor enhancer.","ascorbic acid":"Vitamin C, used as an antioxidant to prevent oxidation and maintain food color and flavor.","sodium chloride":"Common table salt, used for flavoring and food preservation.",sugar:"A sweet crystalline substance obtained from sugar cane or sugar beet, used as a sweetener.","high fructose corn syrup":"A liquid sweetener made from corn starch, commonly used in processed foods.","monosodium glutamate":"A flavor enhancer that adds umami taste to foods.","artificial flavor":"Synthetic compounds that mimic natural flavors to enhance food taste.","natural flavor":"Flavor compounds derived from natural sources like plants, animals, or microorganisms.",carrageenan:"A thickening agent extracted from red seaweed, used to improve texture in dairy and plant-based products.","xanthan gum":"A polysaccharide used as a thickening and stabilizing agent in food products.",lecithin:"An emulsifier that helps mix oil and water-based ingredients, often derived from soybeans or sunflower.","palm oil":"A vegetable oil derived from palm fruit, commonly used in processed foods and associated with deforestation concerns.","modified corn starch":"Corn starch that has been chemically or physically altered to improve its functional properties.","calcium carbonate":"A mineral compound used as a nutritional supplement and food additive for calcium fortification.",iron:"An essential mineral added to foods for nutritional fortification, particularly important for blood health.","vitamin d":"A fat-soluble vitamin added to foods to support bone health and immune function.","folic acid":"A synthetic form of folate (B-vitamin) added to foods to prevent neural tube defects.",bht:"Butylated hydroxytoluene, an antioxidant preservative that prevents rancidity in fats and oils.",bha:"Butylated hydroxyanisole, an antioxidant preservative used to prevent oxidation in foods containing fats."};let i=r[n];if(!i){for(const[u,o]of Object.entries(r))if(n.includes(u)||u.includes(n)){i=o;break}}return!i&&a&&(i=a.split(".")[0]+"."),i||(n.includes("preservative")?i="A substance used to prevent spoilage and extend shelf life of food products.":n.includes("emulsifier")?i="An agent that helps mix oil and water-based ingredients that would normally separate.":n.includes("stabilizer")?i="A substance that maintains the physical and chemical properties of food products.":n.includes("thickener")?i="An agent used to increase the viscosity and improve texture of food products.":n.includes("sweetener")?i="A substance used to add sweetness to food products, either natural or artificial.":n.includes("color")||n.includes("dye")?i="A substance used to add or enhance color in food products.":n.includes("flavor")?i="A substance used to enhance or modify the taste of food products.":n.includes("vitamin")?i="An essential micronutrient added to foods for nutritional fortification.":n.includes("mineral")?i="An inorganic substance added to foods for nutritional supplementation.":i="A food ingredient used in product formulation."),i+({safe:" Scientific evidence and regulatory assessments indicate this ingredient is safe for consumption at typical dietary levels. Extensive toxicological studies support its continued use in food products.",caution:" While generally recognized as safe, some studies suggest potential health concerns with excessive consumption or in sensitive individuals. Moderation is advisable, particularly for those with existing health conditions.",unsafe:" Scientific research has identified potential health risks associated with this ingredient. Regulatory agencies may have imposed restrictions, and consumers should limit exposure when possible."}[t]||" Safety profile requires further evaluation based on current scientific evidence.")},kt=(s,t)=>{const a=s.toLowerCase(),n={"sodium benzoate":[{title:"Safety Assessment of Sodium Benzoate - FDA GRAS Database",url:"https://www.fda.gov/food/food-additives-petitions/food-additive-status-list",summary:"FDA confirms sodium benzoate as Generally Recognized as Safe (GRAS) for use in foods.",confidence:95,peerReviewed:!0},{title:"Benzoic Acid and Sodium Benzoate - EFSA Scientific Opinion",url:"https://www.efsa.europa.eu/en/efsajournal/pub/1020",summary:"European Food Safety Authority assessment of benzoic acid and its sodium salt safety.",confidence:90,peerReviewed:!0}],"high fructose corn syrup":[{title:"High Fructose Corn Syrup and Health Outcomes - American Journal of Clinical Nutrition",url:"https://academic.oup.com/ajcn/article/88/6/1716S/4617107",summary:"Comprehensive review of HFCS consumption and metabolic health effects.",confidence:85,peerReviewed:!0},{title:"FDA Position on High Fructose Corn Syrup",url:"https://www.fda.gov/food/food-additives-petitions/high-fructose-corn-syrup-questions-and-answers",summary:"Official FDA stance on HFCS safety and regulatory status.",confidence:90,peerReviewed:!1}],"palm oil":[{title:"Environmental Impact of Palm Oil Production - Nature Sustainability",url:"https://www.nature.com/articles/s41893-019-0456-2",summary:"Assessment of deforestation and biodiversity impacts from palm oil cultivation.",confidence:95,peerReviewed:!0},{title:"Sustainable Palm Oil Certification - RSPO Standards",url:"https://rspo.org/certification",summary:"Roundtable on Sustainable Palm Oil certification standards and environmental criteria.",confidence:80,peerReviewed:!1}]};if(n[a])return n[a];const r=[];return t==="safe"?(r.push({title:"FDA GRAS (Generally Recognized as Safe) Database",url:"https://www.fda.gov/food/food-additives-petitions/food-additive-status-list",summary:"Comprehensive database of food ingredients recognized as safe by the FDA.",confidence:85,peerReviewed:!1}),r.push({title:"EFSA Food Additives Database",url:"https://www.efsa.europa.eu/en/data/food-additives-flavourings-database",summary:"European Food Safety Authority database of approved food additives.",confidence:90,peerReviewed:!1})):t==="caution"?(r.push({title:"Food Chemical Risk Assessment - Scientific Literature Review",url:"https://pubmed.ncbi.nlm.nih.gov/",summary:"Peer-reviewed research on potential health effects of food chemicals.",confidence:80,peerReviewed:!0}),r.push({title:"WHO/FAO Food Safety Risk Assessment Guidelines",url:"https://www.who.int/publications/i/item/9789241572408",summary:"International guidelines for assessing food safety risks.",confidence:85,peerReviewed:!1})):t==="unsafe"&&(r.push({title:"Toxicological Assessment of Food Additives - Research Database",url:"https://pubmed.ncbi.nlm.nih.gov/",summary:"Scientific studies on potential adverse effects of food additives.",confidence:75,peerReviewed:!0}),r.push({title:"International Agency for Research on Cancer (IARC) Monographs",url:"https://monographs.iarc.who.int/",summary:"Evaluation of carcinogenic risks to humans from chemical exposures.",confidence:95,peerReviewed:!0})),r};function _t({ingredient:s,isOpen:t,onClose:a}){if(!s)return null;const n=At(s.name,s.riskLevel,s.description),r=kt(s.name,s.riskLevel),i=p=>{switch(p){case"safe":return{color:"bg-green-100 text-green-800 hover:bg-green-200",icon:e.jsx(Z,{className:"h-4 w-4 mr-1"}),label:"Safe"};case"caution":return{color:"bg-yellow-100 text-yellow-800 hover:bg-yellow-200",icon:e.jsx(T,{className:"h-4 w-4 mr-1"}),label:"Caution"};case"unsafe":return{color:"bg-red-100 text-red-800 hover:bg-red-200",icon:e.jsx(Ke,{className:"h-4 w-4 mr-1"}),label:"Unsafe"};default:return{color:"bg-blue-100 text-blue-800 hover:bg-blue-200",icon:e.jsx(T,{className:"h-4 w-4 mr-1"}),label:"Unknown Risk"}}},h=p=>{switch(p){case"gmo-free":return{color:"bg-green-100 text-green-800 hover:bg-green-200",icon:e.jsx(Z,{className:"h-4 w-4 mr-1"}),label:"GMO-Free"};case"likely-gmo":return{color:"bg-yellow-100 text-yellow-800 hover:bg-yellow-200",icon:e.jsx(T,{className:"h-4 w-4 mr-1"}),label:"Likely GMO"};case"contains-gmo":return{color:"bg-orange-100 text-orange-800 hover:bg-orange-200",icon:e.jsx(ee,{className:"h-4 w-4 mr-1"}),label:"Contains GMO"};default:return{color:"bg-gray-100 text-gray-800 hover:bg-gray-200",icon:e.jsx(T,{className:"h-4 w-4 mr-1"}),label:"GMO Status Unknown"}}},u=i(s.riskLevel),o=h(s.gmoStatus);return e.jsx(Nt,{open:t,onOpenChange:p=>!p&&a(),children:e.jsxs(as,{className:"max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs(ns,{children:[e.jsxs(rs,{className:"text-xl flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:s.name}),e.jsxs(B,{variant:"outline",className:`ml-2 ${u.color}`,children:[u.icon,u.label]})]}),e.jsx(is,{className:"text-muted-foreground mt-1",children:"Food ingredient information based on scientific evidence"})]}),e.jsx(os,{className:"flex-1 pr-4",children:e.jsxs("div",{className:"space-y-6 py-2",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium mb-2 flex items-center gap-2",children:[e.jsx(Es,{className:"h-4 w-4 text-primary"}),"Definition"]}),e.jsx("p",{className:"text-sm text-muted-foreground bg-muted/30 p-3 rounded-md border-l-4 border-primary",children:n})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[s.gmoStatus&&e.jsxs(B,{className:o.color,children:[o.icon,o.label]}),s.sustainability&&e.jsxs(B,{variant:"outline",className:"text-xs",children:["Sustainability: ",s.sustainability]}),s.allergenicity&&e.jsxs(B,{variant:"outline",className:"text-xs",children:["Allergenicity: ",s.allergenicity]}),s.processing&&e.jsxs(B,{variant:"outline",className:"text-xs",children:["Processing: ",s.processing]})]}),s.concerns&&s.concerns.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Potential Concerns"}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:s.concerns.map((p,A)=>e.jsx("li",{className:"text-sm text-muted-foreground",children:p},A))})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("h3",{className:"text-sm font-medium mb-3 flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4 text-primary"}),"Scientific Evidence"]}),e.jsx("div",{className:"space-y-3",children:[...s.scientificPapers||[],...r.slice(0,3)].map((p,A)=>e.jsx(P,{className:"border border-muted hover:border-primary/30 transition-colors",children:e.jsx(O,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[e.jsx(le,{className:"h-4 w-4 text-primary flex-shrink-0"}),p.peerReviewed&&e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full",title:"Peer Reviewed"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium leading-tight",children:p.title}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:p.summary}),e.jsx("div",{className:"flex items-center justify-between mt-2",children:e.jsxs("a",{href:p.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary inline-flex items-center hover:underline",children:["View Source ",e.jsx(Rs,{className:"h-3 w-3 ml-1"})]})})]})]})})},A))}),r.length===0&&(!s.scientificPapers||s.scientificPapers.length===0)&&e.jsx(P,{className:"border border-muted bg-muted/20",children:e.jsx(O,{className:"p-4 text-center",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Scientific data for this ingredient is being compiled. Check back for updates."})})})]}),e.jsx("div",{className:"mt-6 pt-4 border-t text-xs text-muted-foreground",children:e.jsxs("p",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"h-3 w-3"}),"Information compiled from scientific sources including FDA, EFSA, WHO, and peer-reviewed research. Data may be updated as new research emerges."]})})]})})]})})}const Ct={beverages:.2,snacks:.5,dairy:1.2,meat:5,vegetables:.3,fruits:.2,grains:.4,"processed-foods":1,"plant-based":.3,seafood:2.5,default:.8},Et={beverages:1.5,snacks:2,dairy:5,meat:15,vegetables:.5,fruits:1,grains:1.8,"processed-foods":3,"plant-based":.8,seafood:2,default:2.5};function Fe(s){const a=(s.categories_tags||[]).join(" ").toLowerCase();if(a.includes("beverage")||a.includes("drink")||a.includes("water")||a.includes("juice")||a.includes("soda")||a.includes("beer")||a.includes("wine")||a.includes("alcohol"))return"beverages";if(a.includes("snack")||a.includes("chips")||a.includes("crisp")||a.includes("cookie")||a.includes("biscuit")||a.includes("candy")||a.includes("chocolate")||a.includes("bar"))return"snacks";if(a.includes("dairy")||a.includes("milk")||a.includes("cheese")||a.includes("yogurt")||a.includes("butter")||a.includes("cream"))return"dairy";if(a.includes("meat")||a.includes("beef")||a.includes("pork")||a.includes("chicken")||a.includes("poultry")||a.includes("lamb")||a.includes("fish")||a.includes("seafood"))return"meat";if(a.includes("vegetable")||a.includes("vegetables")||a.includes("legume")||a.includes("salad"))return"vegetables";if(a.includes("fruit")||a.includes("fruits")||a.includes("berry")||a.includes("citrus"))return"fruits";if(a.includes("grain")||a.includes("bread")||a.includes("pasta")||a.includes("rice")||a.includes("cereal")||a.includes("wheat")||a.includes("flour"))return"grains";if(s.ingredients&&s.ingredients.length>0){const n=s.ingredients.map(r=>r.text||r.id||"").join(" ").toLowerCase();if(n.includes("milk")||n.includes("cream")||n.includes("cheese"))return"dairy";if(n.includes("beef")||n.includes("pork")||n.includes("chicken")||n.includes("meat"))return"meat";if(n.includes("wheat")||n.includes("flour")||n.includes("rice")||n.includes("corn"))return"grains"}return"default"}function Rt(s){let t=50;if(s.packaging){const a=s.packaging.toLowerCase();a.includes("plastic")&&(t-=15),(a.includes("single-use")||a.includes("disposable"))&&(t-=10),a.includes("recycled")&&(t+=15),a.includes("recyclable")&&(t+=10),a.includes("glass")&&(t+=5),(a.includes("paper")||a.includes("cardboard"))&&(t+=8),a.includes("biodegradable")&&(t+=20),a.includes("compostable")&&(t+=20)}if(s.ingredients_analysis_tags&&(s.ingredients_analysis_tags.includes("en:palm-oil")&&(t-=20),s.ingredients_analysis_tags.includes("en:non-sustainable-palm-oil")&&(t-=25),s.ingredients_analysis_tags.includes("en:sustainable-palm-oil")&&(t-=5),s.ingredients_analysis_tags.includes("en:organic")&&(t+=15),s.ingredients_analysis_tags.includes("en:fair-trade")&&(t+=10),s.ingredients_analysis_tags.includes("en:local")&&(t+=10),s.ingredients_analysis_tags.includes("en:seasonal")&&(t+=5)),s.labels_tags&&(s.labels_tags.includes("en:rainforest-alliance")&&(t+=10),s.labels_tags.includes("en:eco-score-a")&&(t+=30),s.labels_tags.includes("en:eco-score-b")&&(t+=20),s.labels_tags.includes("en:eco-score-c")&&(t+=10),s.labels_tags.includes("en:eco-score-d")&&(t-=10),s.labels_tags.includes("en:eco-score-e")&&(t-=20)),s.origins_tags){const a=s.origins_tags.join(" ").toLowerCase();(a.includes("local")||a.includes("regional"))&&(t+=15),(a.includes("imported")||a.includes("foreign"))&&(t-=10),(a.includes("air")||a.includes("airfreight"))&&(t-=25)}return Math.max(0,Math.min(100,t))}function Ft(s){switch(s.nutriscore_grade){case"a":return 100;case"b":return 80;case"c":return 60;case"d":return 40;case"e":return 20;default:return 30}}function Dt(s){var a,n;let t=80;if((a=s.allergens_tags)!=null&&a.length&&(t-=s.allergens_tags.length*5),(n=s.additives_tags)!=null&&n.length){const r=Math.min(30,s.additives_tags.length*2);t-=r;const i=["e102","e104","e110","e122","e124","e129","e211","e621"];s.additives_tags.some(u=>i.some(o=>u.toLowerCase().includes(o)))&&(t-=10)}return s.nova_group&&(t-=(s.nova_group-1)*5),s.labels_tags&&(s.labels_tags.some(r=>r.includes("organic"))&&(t+=5),s.labels_tags.some(r=>r.includes("quality")||r.includes("certified"))&&(t+=3)),Math.max(0,Math.min(100,t))}function It(s){var a,n,r,i;const t=[];return(a=s.nutriments)!=null&&a.sugars_100g&&s.nutriments.sugars_100g>10&&t.push("High sugar content"),(n=s.nutriments)!=null&&n.salt_100g&&s.nutriments.salt_100g>1.5&&t.push("High salt content"),(r=s.additives_tags)!=null&&r.length&&s.additives_tags.length>5&&t.push("High number of additives"),(i=s.ingredients_analysis_tags)!=null&&i.includes("en:palm-oil")&&t.push("Contains palm oil"),t}function Tt(s){var r;const t=(s.text||s.id||"").toLowerCase(),a=["sodium nitrite","bha","bht","potassium bromate","propylparaben","butylated hydroxyanisole","butylated hydroxytoluene","propyl gallate","sodium benzoate","monosodium glutamate","msg","artificial color","red 40","yellow 5","yellow 6","blue 1","blue 2","green 3"],n=["palm oil","high fructose corn syrup","corn syrup","aspartame","sucralose","saccharin","acesulfame","carrageenan","partially hydrogenated","soy lecithin"];if(a.some(i=>t.includes(i)))return"unsafe";if(n.some(i=>t.includes(i)))return"caution";if((r=s.id)!=null&&r.startsWith("en:E")){const i=s.id.replace("en:E","");if(/^(102|104|110|120|122|124|129|150|151|155|180|21[0-9]|22[0-9]|23[0-9]|249|250|251|252|310|311|312|320|321|407|621|622|623|624|625)$/.test(i))return"caution"}return s.vegan&&s.vegetarian&&s.organic?"safe":s.from_palm_oil?"unsafe":"caution"}function Pt(s){const t=(s.text||s.id||"").toLowerCase();if(s.organic||s.labels_tags&&s.labels_tags.includes("en:organic"))return{status:"gmo-free",confidence:95};if(s.labels_tags&&(s.labels_tags.includes("en:no-gmo")||s.labels_tags.includes("en:non-gmo-project-verified"))||s.gmo_risk==="None")return{status:"gmo-free",confidence:90};if(s.labels_tags&&s.labels_tags.includes("en:contains-gmo")||s.gmo_risk==="High")return{status:"contains-gmo",confidence:90};if(s.vegan&&s.vegetarian)return{status:"gmo-free",confidence:75};const a=["corn","maize","soy","soybean","canola","rapeseed","cottonseed","sugar beet","papaya","potato"],n=["modified starch","modified food starch","high fructose corn syrup","corn syrup","glucose syrup","dextrose","maltodextrin","soy protein","soy lecithin","vegetable oil","vegetable protein","aspartame","amino acids","ascorbic acid","sodium ascorbate","vitamin c","citric acid","sodium citrate","ethanol","flavoring","natural flavor","hydrolyzed vegetable protein","textured vegetable protein","xanthan gum"];return a.some(r=>t.includes(r))?{status:"likely-gmo",confidence:80}:n.some(r=>t.includes(r))?{status:"likely-gmo",confidence:65}:{status:"likely-gmo",confidence:50}}async function De(s){try{const t=s.replace(/\s+/g,"_"),a=`https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(t)}`,n=await fetch(a);if(!n.ok)return null;const r=await n.json();if(r.extract&&r.extract.length>50){let i=r.extract.replace(/\([^)]*\)/g,"").trim();return i=i.charAt(0).toUpperCase()+i.slice(1),i.length>300&&(i=i.substring(0,300)+"..."),i}return null}catch(t){return console.log(`Failed to fetch Wikipedia definition for ${s}:`,t),null}}async function Ot(s){try{const t={"sodium benzoate":"A preservative that inhibits the growth of potentially harmful bacteria, mold, and other microorganisms in food.","potassium sorbate":"A chemical preservative commonly used in food and drinks to prevent mold.","citric acid":"A natural preservative and flavor enhancer found in citrus fruits.","ascorbic acid":"Also known as Vitamin C, used as a natural antioxidant and preservative.","calcium carbonate":"A common food additive used as an anti-caking agent and nutritional supplement.","sodium chloride":"Common table salt used for flavoring and preservation.",sugar:"A sweet crystalline carbohydrate derived from sugar cane or sugar beet.","corn syrup":"A sweetener made from corn starch, composed primarily of glucose.","high fructose corn syrup":"A liquid sweetener made from corn starch that has been processed to convert glucose into fructose.","artificial flavor":"Chemical compounds created to mimic natural flavors in food products.","natural flavor":"Flavoring substances extracted from natural sources like fruits, vegetables, herbs, or spices.",lecithin:"A natural emulsifier that helps mix oil and water-based ingredients.",carrageenan:"A natural thickening agent extracted from red seaweed.","xanthan gum":"A polysaccharide secreted by bacteria, used as a thickening and stabilizing agent.","guar gum":"A natural thickening agent derived from guar beans.",cellulose:"A natural fiber additive derived from plant cell walls, used as an anti-caking agent.","silicon dioxide":"An anti-caking agent that prevents clumping in powdered foods.","mono and diglycerides":"Emulsifiers that help mix oil and water-based ingredients.","polysorbate 80":"An emulsifier and surfactant used in various food products.","sodium phosphate":"A preservative and pH regulator used in processed foods."},a=s.toLowerCase();for(const[n,r]of Object.entries(t))if(a.includes(n)||n.includes(a))return r;return null}catch(t){return console.log(`Failed to get FDA definition for ${s}:`,t),null}}async function Ut(s){let t=await De(s);if(t&&t.length>100||(t=await Ot(s),t))return t;const a=[s.replace(/\s*\([^)]*\)/g,""),s.split(" ")[0],s.replace(/,.*/,"")];for(const n of a)if(n!==s&&n.length>2&&(t=await De(n),t&&t.length>100))return t;return Lt(s)}function Lt(s){const t=s.toLowerCase(),a=s.charAt(0).toUpperCase()+s.slice(1);return t.includes("preservative")||t.includes("sodium benzoate")||t.includes("potassium sorbate")?`${a} is a food preservative that helps prevent spoilage by inhibiting the growth of bacteria, mold, and yeast, thereby extending the shelf life of food products.`:t.includes("emulsifier")||t.includes("lecithin")||t.includes("mono")||t.includes("diglyceride")?`${a} is an emulsifying agent that helps blend oil and water-based ingredients that would normally separate, creating smooth and stable food textures.`:t.includes("thickener")||t.includes("gum")||t.includes("starch")||t.includes("cellulose")?`${a} is a thickening agent used to increase viscosity and improve the texture and mouthfeel of food products.`:t.includes("sweetener")||t.includes("sugar")||t.includes("syrup")||t.includes("fructose")?`${a} is a sweetening agent used to add sweetness to food products and enhance flavor profiles.`:t.includes("color")||t.includes("dye")||t.includes("pigment")?`${a} is a coloring agent used to enhance or modify the visual appearance of food products.`:t.includes("flavor")||t.includes("aroma")||t.includes("essence")?`${a} is a flavoring agent used to enhance or modify the taste and aroma characteristics of food products.`:t.includes("acid")||t.includes("citric")||t.includes("ascorbic")?`${a} is an acidifying agent and antioxidant used to regulate pH levels and prevent oxidation in food products.`:t.includes("vitamin")||t.includes("mineral")||t.includes("iron")||t.includes("calcium")?`${a} is a nutritional additive used to fortify foods with essential vitamins and minerals for improved nutritional value.`:t.includes("oil")||t.includes("fat")?`${a} is a lipid ingredient used to provide texture, flavor, and nutritional content in food formulations.`:`${a} is a food ingredient with specific functional properties used in food processing and formulation.`}async function Mt(s){if(!s.ingredients||s.ingredients.length===0)return[{name:"Ingredients information unavailable",riskLevel:"caution",description:"Detailed ingredient information is not available for this product.",gmoStatus:"likely-gmo",gmoConfidence:50,sustainability:"medium",allergenicity:"low",processing:"moderate"}];const a=s.ingredients.filter(n=>{const r=(n.text||n.id||"").toLowerCase();return!["contains less than","% of the following","following ingredients","and the following","risk assessment","may contain traces","manufactured in","processed in","produced in a facility"].some(h=>r.includes(h))}).map(async n=>{var l,C,D,I;const r=Pt(n),i=n.text||n.id||"Unknown ingredient",h=i.charAt(0).toUpperCase()+i.slice(1),u=i.toLowerCase(),o=((l=n.scientific_references)==null?void 0:l.map(y=>{var d;return{title:y.title,url:y.url,summary:y.abstract||`Published by ${y.source} ${y.publicationYear?`in ${y.publicationYear}`:""}`,confidence:y.confidenceScore||75,peerReviewed:y.peerReviewed||((d=y.source)==null?void 0:d.includes("Journal"))||!1}}))||[],p=[];n.from_palm_oil&&p.push("Contains palm oil (deforestation risk)"),n.health_concerns&&p.push(...n.health_concerns);let A="medium";n.organic||(C=n.labels_tags)!=null&&C.includes("en:organic")?A="high":n.from_palm_oil&&!((D=n.labels_tags)!=null&&D.includes("en:sustainable-palm-oil"))||u.includes("beef")||u.includes("lamb")||u.includes("mutton")?A="low":(u.includes("local")||u.includes("seasonal")||(I=n.labels_tags)!=null&&I.includes("en:fair-trade"))&&(A="high");let _="low";const L=["milk","dairy","egg","peanut","tree nut","soy","wheat","gluten","fish","shellfish","sesame","mustard","sulfite"];n.allergens||L.some(y=>u.includes(y))?_="high":u.includes("protein")||u.includes("flour")?_="medium":n.vegan&&!u.includes("soy")&&!u.includes("wheat")&&(_="low");let R="moderate";["hydrolyzed","modified","isolate","concentrate","extract","artificial","flavoring","hydrogenated","hydrolysate","textured"].some(y=>u.includes(y))||n.id&&n.id.startsWith("en:E")?R="high":(n.organic||u.includes("raw")||u.includes("fresh"))&&(R="minimal"),_==="high"&&!p.some(y=>y.includes("allergen"))&&p.push("Common allergen");let F=n.description;return(!F||F.trim()==="")&&(F=await Ut(h)),{name:h,riskLevel:Tt(n),description:F,gmoStatus:r.status,gmoConfidence:r.confidence,concerns:p.length>0?p:void 0,scientificPapers:o.length>0?o:void 0,sustainability:A,allergenicity:_,processing:R}});return Promise.all(a)}async function Ie(s,t){var I,y,d,f,m,x,w,N,c,v,b,S,K,H,W,ge,he,pe,xe,ve;const a=s.last_updated||new Date().toISOString().split("T")[0],n=(I=s.environmental_data)!=null&&I.dataReliability?Math.round(100-(s.environmental_data.carbonFootprintScore||0)*10):Rt(s),r=Ft(s),i=Dt(s),h=await Mt(s),u=It(s),p={a:"A",b:"B",c:"C",d:"D",e:"E"}[s.nutriscore_grade||"c"]||"C",A=((y=s.environmental_data)==null?void 0:y.carbonFootprintScore)||s.carbon_footprint_per_100g||Ct[t],_=((d=s.environmental_data)==null?void 0:d.waterUsage)||((f=s.ecoscore_data)==null?void 0:f.water_usage_score)||Et[t],L=(m=s.environmental_data)!=null&&m.packagingWaste?Math.round(5-s.environmental_data.packagingWaste*10):(x=s.packaging)!=null&&x.toLowerCase().includes("recycled")?4:(w=s.packaging)!=null&&w.toLowerCase().includes("plastic")?2:3,R=((N=s.environmental_data)==null?void 0:N.landUseScore)||(t==="meat"?4.2:t==="dairy"?3.5:t==="snacks"?2.8:t==="grains"?1.5:t==="fruits"?.9:t==="vegetables"?.8:2),q=((c=s.environmental_data)==null?void 0:c.biodiversityImpact)||(t==="meat"?4:t==="dairy"?3.2:t==="snacks"?2.5:t==="grains"?1.8:t==="fruits"?1:t==="vegetables"?.9:2.3),F=(v=s.ingredients_analysis_tags)!=null&&v.includes("en:palm-oil")?3.5:t==="meat"?2.8:t==="dairy"?2:t==="snacks"?1.5:.5,l=((b=s.ingredients_analysis_tags)==null?void 0:b.includes("en:no-gmo"))||((S=s.ingredients_analysis_tags)==null?void 0:S.includes("en:gmo-free"))||h.length>0&&h.every(cs=>cs.gmoStatus==="gmo-free"),C=(K=s.environmental_data)!=null&&K.waterSource?`Based on ${s.environmental_data.waterSource} data`:"Based on product category, composition, and packaging analysis";s.data_quality_score||Math.round((n+r+i)/5);const D=["OpenFoodFacts"];return(H=s.environmental_data)!=null&&H.waterSource&&D.push(s.environmental_data.waterSource),{productName:s.product_name||"Unknown Product",brand:s.brands||"Unknown Brand",productImage:s.image_front_url||s.image_url||"/placeholder.svg",barcode:s.code||"",overallScore:Math.round((n+r+i)/3),environmentalScore:n,nutritionalScore:r,safetyScore:i,gmoFree:l,concerns:u,ingredients:h,environmental:{carbonFootprint:A,waterFootprint:_,packagingScore:L,transportScore:(W=s.environmental_data)!=null&&W.transportEmissions?Math.round(s.environmental_data.transportEmissions*2):3,landUse:R,biodiversityImpact:q,deforestationRisk:F,methodology:C,confidenceScore:0},nutritional:{nutriScore:p,calories:((ge=s.nutriments)==null?void 0:ge.energy_100g)||0,sugar:((he=s.nutriments)==null?void 0:he.sugars_100g)||0,salt:((pe=s.nutriments)==null?void 0:pe.salt_100g)||0,saturatedFat:((xe=s.nutriments)==null?void 0:xe["saturated-fat_100g"])||0,fiber:((ve=s.nutriments)==null?void 0:ve.fiber_100g)||0},dataSource:D.join(", "),lastUpdated:a,trustScore:0}}function Bt(s,t,a){const n=s.toLowerCase(),r=a.split(".")[0]+".",i=t==="safe"?" Generally recognized as safe for consumption.":t==="caution"?" Should be consumed in moderation; may cause sensitivity in some individuals.":" Associated with health concerns; limit consumption when possible.",h={preservative:" Functions by inhibiting microbial growth, extending shelf life.",emulsifier:" Works by reducing surface tension between oil and water phases.",thickener:" Increases viscosity through molecular interactions with water.",sweetener:" Provides sweetness with varying metabolic effects.",flavor:" Enhances taste perception through chemical compound interactions.",color:" Modifies visual appearance through light absorption properties.",stabilizer:" Maintains product consistency through molecular stabilization.",antioxidant:" Prevents oxidation by neutralizing free radicals."};let u="";for(const[o,p]of Object.entries(h))if(n.includes(o)||a.toLowerCase().includes(o)){u=p;break}return r+u+i}function zt({barcode:s}){const{data:t,isLoading:a,error:n}=yt(s),{data:r,isLoading:i}=wt(s),[h,u]=g.useState(null),[o,p]=g.useState(null),[A,_]=g.useState(!1);g.useEffect(()=>{_(!1),(async()=>{var C,D,I,y,d,f,m,x,w,N;if(t){const c=Fe(t),v=await Ie(t,c);p(v);return}if(r){if(r.openFoodFacts.success&&r.openFoodFacts.data){const c=r.openFoodFacts.data,v=Fe(c),b=await Ie(c,v);b.trustScore=(b.trustScore||70)-10,b.dataSource="OpenFoodFacts (fallback)",p(b);return}if(r.usda.success&&r.usda.data){const c=r.usda.data,v={productName:c.description||"Unknown Product",brand:c.brandOwner||"Unknown Brand",productImage:c.foodImage||"placeholder.svg",barcode:s,overallScore:50,environmentalScore:50,nutritionalScore:60,safetyScore:70,gmoFree:!1,concerns:["Limited data available from USDA"],ingredients:[{name:"Ingredients data limited",riskLevel:"caution",description:"Full ingredient analysis not available from USDA data source.",sustainability:"medium",allergenicity:"low",processing:"moderate",gmoStatus:"likely-gmo",gmoConfidence:50}],environmental:{carbonFootprint:1,waterFootprint:2,packagingScore:50,transportScore:50,deforestationRisk:2,biodiversityImpact:2.5,landUse:2,methodology:"Estimated based on USDA food category",confidenceScore:60},nutritional:{nutriScore:"C",calories:((D=(C=c.nutrients)==null?void 0:C.find(b=>b.name==="Energy"))==null?void 0:D.amount)||0,sugar:((y=(I=c.nutrients)==null?void 0:I.find(b=>b.name==="Sugars, total"))==null?void 0:y.amount)||0,salt:((f=(d=c.nutrients)==null?void 0:d.find(b=>b.name==="Sodium, Na"))==null?void 0:f.amount)||0,saturatedFat:((x=(m=c.nutrients)==null?void 0:m.find(b=>b.name==="Fatty acids, total saturated"))==null?void 0:x.amount)||0,fiber:((N=(w=c.nutrients)==null?void 0:w.find(b=>b.name==="Fiber, total dietary"))==null?void 0:N.amount)||0},dataSource:"USDA FoodData Central",lastUpdated:new Date().toISOString().split("T")[0],trustScore:60};p(v);return}if(r.efsa.success&&r.efsa.data){const c=r.efsa.data,v={productName:c.name||"Unknown Product",brand:c.brand||"Unknown Brand",productImage:"placeholder.svg",barcode:s,overallScore:50,environmentalScore:45,nutritionalScore:55,safetyScore:65,gmoFree:!1,concerns:["Limited data available from EFSA"],ingredients:[{name:"Ingredients data limited",riskLevel:"caution",description:"Full ingredient analysis not available from EFSA data source.",sustainability:"medium",allergenicity:"low",processing:"moderate",gmoStatus:"likely-gmo",gmoConfidence:50}],environmental:{carbonFootprint:1.2,waterFootprint:2.5,packagingScore:45,transportScore:45,deforestationRisk:1.5,biodiversityImpact:2,landUse:2.5,methodology:"Estimated based on EFSA product category",confidenceScore:65},nutritional:{nutriScore:"C",calories:0,sugar:0,salt:0,saturatedFat:0,fiber:0},dataSource:"European Food Safety Authority",lastUpdated:new Date().toISOString().split("T")[0],trustScore:65};p(v);return}}})()},[t,r,s]);const L=()=>u(null),R=l=>{u(l)};if(a||i)return e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx(Y,{value:30,className:"w-[200px]"})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Analyzing product..."})]})});if(n)return e.jsx(P,{className:"border-destructive",children:e.jsx(O,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col items-center text-center gap-2",children:[e.jsx(T,{className:"h-8 w-8 text-destructive"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:typeof n=="object"&&n!==null&&"message"in n?n.message:"Failed to analyze product"}),e.jsx(E,{variant:"outline",size:"sm",onClick:()=>window.location.reload(),children:"Try Again"})]})})});if(!o)return null;const q=l=>{switch(l){case"gmo-free":return e.jsx(Z,{className:"h-4 w-4 text-green-500"});case"likely-gmo":return e.jsx(T,{className:"h-4 w-4 text-yellow-500"});case"contains-gmo":return e.jsx(Ke,{className:"h-4 w-4 text-red-500"});default:return e.jsx(T,{className:"h-4 w-4 text-gray-400"})}},F=l=>{switch(l){case"A":return"bg-green-500 text-white";case"B":return"bg-green-400 text-white";case"C":return"bg-yellow-400 text-black";case"D":return"bg-orange-500 text-white";case"E":return"bg-red-500 text-white";default:return"bg-gray-400 text-white"}};return e.jsxs(P,{className:"w-full max-w-4xl mx-auto",children:[e.jsx(_t,{ingredient:h,isOpen:!!h,onClose:L}),e.jsx(z,{className:"pb-4",children:e.jsxs($,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[A?e.jsx("div",{className:"w-24 h-24 flex items-center justify-center rounded-lg bg-gray-100 border-2 border-gray-200",children:e.jsx("img",{src:"/placeholder.svg",alt:"Product placeholder",className:"w-16 h-16 object-contain opacity-50"})}):e.jsx("img",{src:o.productImage,alt:o.productName,className:"w-24 h-24 object-contain rounded-lg bg-white shadow-sm border-2 border-gray-100",onError:()=>_(!0)}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:o.productName}),e.jsx("p",{className:"text-muted-foreground",children:o.brand}),o.nutritional.calories>0&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[e.jsxs("span",{className:"font-medium",children:[o.nutritional.calories," calories"]})," per 100g"]})]})]}),e.jsx(B,{variant:"outline",className:"text-xs",children:o.barcode})]})}),e.jsxs(O,{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 bg-card rounded-lg border",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold mb-1",children:"Overall Score"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Based on environmental, nutritional, and safety factors"})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:k("inline-block px-4 py-2 rounded-xl text-lg font-bold",o.overallScore>=70?"bg-green-500 text-white":o.overallScore>=40?"bg-yellow-500 text-white":"bg-red-500 text-white"),children:[o.overallScore,"/100"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(P,{children:[e.jsx(z,{className:"pb-2",children:e.jsxs($,{className:"text-lg flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5 text-green-500"}),"Environmental"]})}),e.jsx(O,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{value:o.environmentalScore,className:"h-2"}),e.jsxs("p",{className:"text-sm text-muted-foreground text-right",children:[o.environmentalScore,"/100"]})]})})]}),e.jsxs(P,{children:[e.jsx(z,{className:"pb-2",children:e.jsxs($,{className:"text-lg flex items-center gap-2",children:[e.jsx(ce,{className:"h-5 w-5 text-yellow-500"}),"Nutritional"]})}),e.jsx(O,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{value:o.nutritionalScore,className:"h-2"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:k("px-2 py-0.5 rounded text-sm font-medium",F(o.nutritional.nutriScore)),children:["Nutri-Score ",o.nutritional.nutriScore]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[o.nutritionalScore,"/100"]})]})]})})]}),e.jsxs(P,{children:[e.jsx(z,{className:"pb-2",children:e.jsxs($,{className:"text-lg flex items-center gap-2",children:[e.jsx(Fs,{className:"h-5 w-5 text-blue-500"}),"Safety"]})}),e.jsx(O,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{value:o.safetyScore,className:"h-2"}),e.jsxs("p",{className:"text-sm text-muted-foreground text-right",children:[o.safetyScore,"/100"]})]})})]})]}),o.concerns.length>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-red-700 mb-2 flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5"}),"Key Concerns"]}),e.jsx("ul",{className:"space-y-1",children:o.concerns.map((l,C)=>e.jsxs("li",{className:"text-red-600 text-sm flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4"}),l]},C))})]}),e.jsxs("div",{className:k("p-4 rounded-lg border",o.gmoFree?"bg-green-50 border-green-200":"bg-yellow-50 border-yellow-200"),children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:o.gmoFree?e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{className:"text-green-700",children:"GMO-Free"})]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"h-5 w-5 text-yellow-500"}),e.jsx("span",{className:"text-yellow-700",children:"GMO Status Uncertain"})]})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o.gmoFree?"This product has been verified to be free from genetically modified organisms.":"The GMO status of this product could not be determined with high confidence. Check individual ingredients for more details."})]}),e.jsxs(Ce,{defaultOpen:!0,children:[e.jsx(Ee,{asChild:!0,children:e.jsxs(E,{variant:"outline",className:"w-full justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),"Ingredient Analysis"]}),e.jsx(be,{className:"h-4 w-4"})]})}),e.jsx(Re,{className:"mt-4",children:e.jsx("div",{className:"max-w-4xl mx-auto space-y-3",children:o.ingredients.length>0?o.ingredients.map((l,C)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("h4",{className:"font-medium text-sm",children:l.name}),e.jsx("button",{onClick:()=>R(l),className:"p-1 text-muted-foreground hover:text-foreground transition-colors",title:"More information",children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 16v-4"}),e.jsx("path",{d:"M12 8h.01"})]})})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(B,{className:k("text-xs",l.riskLevel==="safe"?"bg-green-100 text-green-800":l.riskLevel==="caution"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:l.riskLevel==="safe"?"âœ“ Safe":l.riskLevel==="caution"?"âš  Caution":"âš  Unsafe"}),e.jsxs("div",{className:"flex items-center gap-1 text-xs px-2 py-1 rounded bg-gray-100",children:[q(l.gmoStatus),e.jsx("span",{className:"text-xs",children:l.gmoStatus==="gmo-free"?"GMO-Free":l.gmoStatus==="contains-gmo"?"Contains GMO":"May contain GMO"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[e.jsxs("span",{children:["Processing: ",e.jsx("span",{className:k("font-medium",l.processing==="minimal"?"text-green-600":l.processing==="moderate"?"text-yellow-600":"text-red-600"),children:l.processing||"moderate"})]}),e.jsxs("span",{children:["Allergenicity: ",e.jsx("span",{className:k("font-medium",l.allergenicity==="none"||l.allergenicity==="low"?"text-green-600":l.allergenicity==="medium"?"text-yellow-600":"text-red-600"),children:l.allergenicity||"low"})]}),e.jsxs("span",{children:["Sustainability: ",e.jsx("span",{className:k("font-medium",l.sustainability==="high"?"text-green-600":l.sustainability==="medium"?"text-yellow-600":"text-red-600"),children:l.sustainability||"medium"})]})]})]})]}),l.description&&e.jsx("div",{className:"pl-4",children:e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed mb-3",children:Bt(l.name,l.riskLevel,l.description)})}),l.scientificPapers&&l.scientificPapers.length>0&&e.jsx("div",{className:"mt-3 pt-2 border-t",children:e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(le,{className:"h-3 w-3"}),e.jsxs("span",{children:["Scientific Research: ",l.scientificPapers.length," ",l.scientificPapers.length===1?"study":"studies"," available"]})]})})]},C)):e.jsx("p",{className:"text-sm text-muted-foreground p-4 border rounded-lg",children:"No detailed ingredient information available for this product."})})})]}),e.jsxs(Ce,{children:[e.jsx(Ee,{asChild:!0,children:e.jsxs(E,{variant:"outline",className:"w-full justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),"Environmental Impact"]}),e.jsx(be,{className:"h-4 w-4"})]})}),e.jsxs(Re,{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("h4",{className:"font-medium",children:"Carbon Footprint"})]}),e.jsx("p",{className:"text-2xl font-bold",children:o.environmental.carbonFootprint.toFixed(2)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"kg COâ‚‚ eq/100g"})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ds,{className:"h-4 w-4"}),e.jsx("h4",{className:"font-medium",children:"Water Usage"})]}),e.jsx("p",{className:"text-2xl font-bold",children:o.environmental.waterFootprint.toFixed(1)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"L/100g"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Additional Environmental Metrics"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Is,{className:"h-3 w-3"}),e.jsx("h5",{className:"text-xs font-medium",children:"Deforestation Risk"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-full bg-gray-200 h-1.5 rounded-full overflow-hidden",children:e.jsx("div",{className:k("h-full rounded-full",o.environmental.deforestationRisk<=1.5?"bg-green-500":o.environmental.deforestationRisk<=3?"bg-yellow-500":"bg-red-500"),style:{width:`${o.environmental.deforestationRisk*20}%`}})}),e.jsx("span",{className:"text-xs font-semibold",children:o.environmental.deforestationRisk.toFixed(1)})]})]}),e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Q,{className:"h-3 w-3"}),e.jsx("h5",{className:"text-xs font-medium",children:"Biodiversity Impact"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-full bg-gray-200 h-1.5 rounded-full overflow-hidden",children:e.jsx("div",{className:k("h-full rounded-full",o.environmental.biodiversityImpact<=1.5?"bg-green-500":o.environmental.biodiversityImpact<=3?"bg-yellow-500":"bg-red-500"),style:{width:`${o.environmental.biodiversityImpact*20}%`}})}),e.jsx("span",{className:"text-xs font-semibold",children:o.environmental.biodiversityImpact.toFixed(1)})]})]}),e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ts,{className:"h-3 w-3"}),e.jsx("h5",{className:"text-xs font-medium",children:"Land Use"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-full bg-gray-200 h-1.5 rounded-full overflow-hidden",children:e.jsx("div",{className:k("h-full rounded-full",o.environmental.landUse<=1.5?"bg-green-500":o.environmental.landUse<=3?"bg-yellow-500":"bg-red-500"),style:{width:`${o.environmental.landUse*20}%`}})}),e.jsx("span",{className:"text-xs font-semibold",children:o.environmental.landUse.toFixed(1)})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ps,{className:"h-4 w-4"}),e.jsx("h5",{className:"text-sm font-medium",children:"Packaging"})]}),e.jsxs("div",{className:"flex items-center mt-1",children:[[1,2,3,4,5].map(l=>e.jsx("div",{className:k("w-6 h-6 rounded-full flex items-center justify-center",l<=o.environmental.packagingScore?"bg-green-100 text-green-600":"bg-gray-100 text-gray-300"),children:e.jsx("span",{className:"text-xs",children:l})},l)),e.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:o.environmental.packagingScore>=4?"Excellent":o.environmental.packagingScore>=3?"Good":o.environmental.packagingScore>=2?"Average":"Poor"})]})]}),e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("h5",{className:"text-sm font-medium",children:"Transport"})]}),e.jsxs("div",{className:"flex items-center mt-1",children:[[1,2,3,4,5].map(l=>e.jsx("div",{className:k("w-6 h-6 rounded-full flex items-center justify-center",l<=o.environmental.transportScore?"bg-green-100 text-green-600":"bg-gray-100 text-gray-300"),children:e.jsx("span",{className:"text-xs",children:l})},l)),e.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:o.environmental.transportScore>=4?"Excellent":o.environmental.transportScore>=3?"Good":o.environmental.transportScore>=2?"Average":"Poor"})]})]})]})]}),e.jsx("div",{className:"border-t pt-2 mt-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Data Confidence:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-24 bg-gray-200 h-1.5 rounded-full overflow-hidden",children:e.jsx("div",{className:k("h-full rounded-full",o.environmental.confidenceScore>=80?"bg-green-500":o.environmental.confidenceScore>=50?"bg-yellow-500":"bg-red-500"),style:{width:`${o.environmental.confidenceScore}%`}})}),e.jsxs("span",{className:"text-xs font-medium",children:[o.environmental.confidenceScore,"%"]})]})]})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Methodology: ",o.environmental.methodology]})]})]}),e.jsx("div",{className:"text-xs text-muted-foreground border-t pt-4",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:["Data source: ",o.dataSource]}),e.jsxs("div",{children:["Last updated: ",o.lastUpdated]})]})})]})]})}const $t=()=>{const[s,t]=g.useState(null),a=r=>{t(r)},n=()=>{t(null)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary/5 via-background to-accent/5 p-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12 pt-8",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center gap-0 mb-8",children:[e.jsx("img",{src:"/gusto-logo.svg",alt:"Gusto Logo",className:"w-40 h-40 transition-transform hover:scale-110 duration-300 drop-shadow-lg"}),e.jsx("h1",{className:"text-6xl font-bold bg-gradient-to-r from-primary via-accent to-secondary bg-clip-text text-transparent leading-tight -mt-14",children:"Gusto"})]}),e.jsx("p",{className:"text-xl text-muted-foreground max-w-3xl mx-auto leading-relaxed",children:"An evidence-based food transparency tool providing comprehensive analysis of food products through barcode scanning, with detailed environmental impact and nutritional insights based on scientific research."}),e.jsxs("div",{className:"flex justify-center gap-6 mt-6 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4 text-primary"}),e.jsx("span",{children:"Environmental Impact"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4 text-secondary"}),e.jsx("span",{children:"Nutritional Analysis"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4 text-accent"}),e.jsx("span",{children:"Scientific Evidence"})]})]})]}),e.jsx("div",{className:"space-y-8",children:s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-center items-center gap-4",children:[e.jsx("img",{src:"/gusto-logo.svg",alt:"Gusto Logo",className:"w-8 h-8"}),e.jsxs(E,{onClick:n,variant:"outline",size:"lg",className:"border-2 border-primary/20 hover:border-primary/40 hover:bg-primary/5",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Scan Another Product"]})]}),e.jsx(zt,{barcode:s})]}):e.jsxs("div",{className:"flex flex-col items-center space-y-8",children:[e.jsx(gt,{onScanResult:a}),e.jsxs("div",{className:"text-center max-w-2xl",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-foreground",children:"How Gusto Works"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 text-left",children:[e.jsxs("div",{className:"bg-card rounded-xl p-6 border shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(Os,{className:"h-5 w-5 text-primary"})}),e.jsx("h3",{className:"font-semibold",children:"Evidence-Based Analysis"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Comprehensive analysis of ingredients, nutritional content, and environmental impact using peer-reviewed scientific research"})]}),e.jsxs("div",{className:"bg-card rounded-xl p-6 border shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-secondary/10",children:e.jsx(ce,{className:"h-5 w-5 text-secondary"})}),e.jsx("h3",{className:"font-semibold",children:"Scientific Evidence"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Every analysis backed by scientific papers and regulatory data for transparent, evidence-based insights"})]}),e.jsxs("div",{className:"bg-card rounded-xl p-6 border shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-accent/10",children:e.jsx(Q,{className:"h-5 w-5 text-accent"})}),e.jsx("h3",{className:"font-semibold",children:"Sustainability Focus"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Calculate carbon footprint, water usage, land use, biodiversity impact, and packaging sustainability using industry-standard LCA methodologies"})]}),e.jsxs("div",{className:"bg-card rounded-xl p-6 border shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(te,{className:"h-5 w-5 text-primary"})}),e.jsx("h3",{className:"font-semibold",children:"Advanced Barcode Scanning"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"High-precision barcode recognition with adaptive image processing, covering products from European and American markets"})]})]})]})]})}),e.jsx("div",{className:"text-center mt-16 pb-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Gusto Food Scanner combines trusted scientific data sources with standardized environmental metrics to empower sustainable food choices."}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-4 text-xs text-muted-foreground",children:[e.jsx("span",{children:"ðŸ”¬ Scientific Evidence"}),e.jsx("span",{children:"ðŸŒ± Environmental Impact"}),e.jsx("span",{children:"ðŸ’§ Water Footprint"}),e.jsx("span",{children:"ðŸŒ² Deforestation Risk"}),e.jsx("span",{children:"ðŸŒ Biodiversity Impact"}),e.jsx("span",{children:"ðŸ“¦ Packaging Assessment"}),e.jsx("span",{children:"ðŸ§¬ GMO Detection"}),e.jsx("span",{children:"â„¹ï¸ Ingredient Definitions"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-4",children:"For educational and informational purposes. Consult healthcare professionals for dietary advice."})]})})]})})},Gt=()=>{const s=Us();return g.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",s.pathname)},[s.pathname]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),e.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),e.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},qt=()=>e.jsx(it,{children:e.jsxs(tt,{children:[e.jsx(et,{}),e.jsx(st,{}),e.jsx(Ls,{children:e.jsxs(Ms,{children:[e.jsx(ye,{path:"/",element:e.jsx($t,{})}),e.jsx(ye,{path:"*",element:e.jsx(Gt,{})})]})})]})});window.React=G;globalThis.React=G;typeof globalThis<"u"&&(globalThis.React=G);typeof window<"u"&&(window.React=G,globalThis.React=G);typeof globalThis<"u"&&(globalThis.React=G);const Ht=()=>{try{if(console.log("Starting application mount..."),!G||!g.createContext)throw new Error("React is not properly loaded");const s=document.getElementById("root");if(!s){console.error("Root element not found!");return}console.log("Root element found, creating React root...");const t=Bs(s);console.log("React root created, rendering app..."),t.render(e.jsx(g.StrictMode,{children:e.jsxs(zs,{client:Vs,children:[e.jsx(qt,{}),e.jsx($s,{initialIsOpen:!1,position:"bottom"})]})})),console.log("Application mounted successfully")}catch(s){const t=`Failed to mount application: ${s instanceof Error?s.message:String(s)}`;console.error(t);const a=document.getElementById("root");a&&(a.innerHTML=`
        <div style="padding: 20px; text-align: center; font-family: sans-serif;">
          <h1>Something went wrong</h1>
          <p>${t}</p>
          <button onclick="window.location.reload()">Reload</button>
        </div>
      `)}};Ht();
